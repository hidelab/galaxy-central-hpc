define(["mvc/dataset/states","mvc/base-mvc","utils/localization"],function(a,b,c){var f=function e(i,j){return[i,j].join("-")};var d={defaults:{history_id:null,history_content_type:"dataset_collection",hid:0,name:"(unnamed content)",state:"new",deleted:false,visible:true,accessible:true,purged:false},idAttribute:"type_id",constructor:function(j,i){this.info("HistoryContentMixin.constructor:",this,j,i);j.type_id=f(j.history_content_type,j.id);Backbone.Model.apply(this,arguments)},_typeIdStr:function(){return f(this.get("history_content_type"),this.get("id"))},initialize:function(j,i){this.debug("HistoryContentMixin.initialize",j,i);this.on("change:id",this._createTypeId);this._setUpListeners()},_setUpListeners:function(){},_createTypeId:function(){this.set("type_id",this._typeIdStr())},hidden:function(){return !this.get("visible")},isVisible:function(j,k){var i=true;if((!j)&&(this.get("deleted")||this.get("purged"))){i=false}if((!k)&&(!this.get("visible"))){i=false}return i},isDeletedOrPurged:function(){return(this.get("deleted")||this.get("purged"))},inReadyState:function(){var i=_.contains(a.READY_STATES,this.get("state"));return(this.isDeletedOrPurged()||i)},hasDetails:function(){return true},hasData:function(){return true},urlRoot:galaxy_config.root+"api/histories/",url:function(){var i=this.urlRoot+this.get("history_id")+"/contents/"+this.get("history_content_type")+"s/"+this.get("id");return i},urls:function(){return{}},"delete":function(i){if(this.get("deleted")){return jQuery.when()}return this.save({deleted:true},i)},undelete:function(i){if(!this.get("deleted")||this.get("purged")){return jQuery.when()}return this.save({deleted:false},i)},hide:function(i){if(!this.get("visible")){return jQuery.when()}return this.save({visible:false},i)},unhide:function(i){if(this.get("visible")){return jQuery.when()}return this.save({visible:true},i)},purge:function h(i){return jQuery.when()},searchAttributes:["name"],searchAliases:{title:"name"},searchAttribute:function(k,i){var j=this.get(k);if(!i||(j===undefined||j===null)){return false}if(_.isArray(j)){return this._searchArrayAttribute(j,i)}return(j.toString().toLowerCase().indexOf(i.toLowerCase())!==-1)},_searchArrayAttribute:function(j,i){i=i.toLowerCase();return _.any(j,function(k){return(k.toString().toLowerCase().indexOf(i.toLowerCase())!==-1)})},search:function(i){var j=this;return _.filter(this.searchAttributes,function(k){return j.searchAttribute(k,i)})},matches:function(j){var l="=",i=j.split(l);if(i.length>=2){var k=i[0];k=this.searchAliases[k]||k;return this.searchAttribute(k,i[1])}return !!this.search(j).length},matchesAll:function(j){var i=this;j=j.match(/(".*"|\w*=".*"|\S*)/g).filter(function(k){return !!k});return _.all(j,function(k){k=k.replace(/"/g,"");return i.matches(k)})},toString:function(){var i=this.get("id")||"";if(this.get("name")){i=this.get("hid")+' :"'+this.get("name")+'",'+i}return"HistoryContent("+i+")"}};var g=Backbone.Model.extend(b.LoggableMixin).extend(d);g.typeIdStr=f;return{HistoryContentMixin:d,HistoryContent:g}});